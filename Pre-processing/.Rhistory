knitr::opts_chunk$set(echo = TRUE)
teams <- fread(paste(dir,'Teams.csv',sep=','))
dir <- '/Users/Marcelpv96/Dropbox/MASTER/1rANY/Q2/ML/Project/ML-Project/input'
library(data.table)
library(dplyr)
library(magrittr)
library(ggplot2)
library(gridExtra)
library(ggExtra)
library(corrplot)
teams <- fread(paste(dir,'Teams.csv',sep=','))
seas_enrich <- fread(paste(dir,'NCAASeasonDetailedResultsEnrichedv2.csv',sep=''))
teams <- fread(paste(dir,'Teams.csv',sep=''))
dir <- '/Users/Marcelpv96/Dropbox/MASTER/1rANY/Q2/ML/Project/ML-Project/input/'
# Data Section 1
teams <- fread(paste(dir,'Teams.csv',sep=''))
teams <- fread(paste(dir,'Teams.csv',sep=''))
seasons <- fread(paste(dir,'Seasons.csv',sep=''))
seeds <- fread(paste(dir,'NCAATourneySeeds.csv',sep=''))
seas_results <- fread(paste(dir,'RegularSeasonCompactResults.csv',sep=''))
tour_results <- fread(paste(dir,'NCAATourneyCompactResults.csv',sep=''))
seas_detail <- fread(paste(dir,'RegularSeasonDetailedResults.csv',sep=''))
tour_detail <- fread(paste(dir,'NCAATourneyDetailedResults.csv',sep=''))
conferences <- fread(paste(dir,'Conferences.csv',sep=''))
team_conferences <- fread(paste(dir,'TeamConferences.csv',sep=''))
coaches <- fread(paste(dir,'TeamCoaches.csv',sep=''))
tour_enrich <- fread(paste(dir,'NCAATourneyDetailedResultsEnriched.csv',sep=''))
seas_enrich <- fread(paste(dir,'NCAASeasonDetailedResultsEnrichedv2.csv',sep=''))
teams
is.na(teams)
sum(is.na(teams))
sum(is.na(seeds)
sum(is.na(seeds))
sum(is.na(seeds))
sum(is.na(seasons))
sum(is.na(seas_results))
sum(is.na(tour_results))
temp = list.files(pattern=paste(dir, "*.csv", sep=''))
myfiles = lapply(temp, read.delim)
View(myfiles)
temp
temp = list.files(pattern="/Users/Marcelpv96/Dropbox/MASTER/1rANY/Q2/ML/Project/ML-Project/input/*.csv")
temp
temp = list.files(path=dir, pattern="*.csv")
temp
list_files = list.files(path=dir, pattern="*.csv")
length(list_files)
for (i in 1:length(list_files)){
assign(file_list[i],read.csv(paste(dir, file_list[i], sep='')))
}
list_files = list.files(path=dir, pattern="*.csv")
for (i in 1:length(list_files)){
assign(list_files[i],read.csv(paste(dir, file_list[i], sep='')))
}
list_files = list.files(path=dir, pattern="*.csv")
for (i in 1:length(list_files)){
assign(list_files[i],read.csv(paste(dir, list_files[i], sep='')))
}
list_files
dir <- '/Users/Marcelpv96/Dropbox/MASTER/1rANY/Q2/ML/Project/ML-Project/input/'
list_files = list.files(path=dir, pattern="*.csv")
assign(list_files[i],read.csv(paste(dir, list_files[i], sep='')))
for (i in 1:length(list_files)){
assign(list_files[i],read.csv(paste(dir, list_files[i], sep='')))
}
all_df = c()
all_df[1] = 3
all_df[2] = 4
list_files = list.files(path=dir, pattern="*.csv")
all_df = c()
for (i in 1:length(list_files)){
all_df[i] = read.csv(paste(dir, list_files[i], sep=''))
}
list_files
list_files
list_files = list.files(path=dir, pattern="*.csv")
dir <- '/Users/Marcelpv96/Dropbox/MASTER/1rANY/Q2/ML/Project/ML-Project/input/'
list_files = list.files(path=dir, pattern="*.csv")
all_df = c()
for (i in 1:length(list_files)){
all_df[i] = read.csv(paste(dir, list_files[i], sep=''))
}
all_df[1]
paste("> ",1+2,sep="")
paste("> ",1+2,,"a",sep="")
paste("> ",1+2,"a",sep="")
for (i in 1:length(list_files)){
print(paste("> File <",list_files[i] ,"> has a number of: ", sum(is.na(all_df))," missing values.", sep='' ))
}
detect_missings <- function(dir){
list_files = list.files(path=dir, pattern="*.csv")
all_df = c()
for (i in 1:length(list_files)){
all_df[i] = read.csv(paste(dir, list_files[i], sep=''))
}
for (i in 1:length(list_files)){
print(paste("> File <",list_files[i] ,"> has a number of: ", sum(is.na(all_df))," missing values.", sep='' ))
}
}
detect_missings(dir)
teams <- fread(paste(dir,'Teams.csv',sep=''))
seasons <- fread(paste(dir,'Seasons.csv',sep=''))
seeds <- fread(paste(dir,'NCAATourneySeeds.csv',sep=''))
seas_results <- fread(paste(dir,'RegularSeasonCompactResults.csv',sep=''))
tour_results <- fread(paste(dir,'NCAATourneyCompactResults.csv',sep=''))
seas_detail <- fread(paste(dir,'RegularSeasonDetailedResults.csv',sep=''))
tour_detail <- fread(paste(dir,'NCAATourneyDetailedResults.csv',sep=''))
conferences <- fread(paste(dir,'Conferences.csv',sep=''))
team_conferences <- fread(paste(dir,'TeamConferences.csv',sep=''))
coaches <- fread(paste(dir,'TeamCoaches.csv',sep=''))
tour_enrich <- fread(paste(dir,'NCAATourneyDetailedResultsEnriched.csv',sep=''))
seas_enrich <- fread(paste(dir,'NCAASeasonDetailedResultsEnrichedv2.csv',sep=''))
teams <- fread(paste(dir,'Teams.csv',sep=''))
seasons <- fread(paste(dir,'Seasons.csv',sep=''))
seeds <- fread(paste(dir,'NCAATourneySeeds.csv',sep=''))
seas_results <- fread(paste(dir,'RegularSeasonCompactResults.csv',sep=''))
tour_results <- fread(paste(dir,'NCAATourneyCompactResults.csv',sep=''))
seas_detail <- fread(paste(dir,'RegularSeasonDetailedResults.csv',sep=''))
tour_detail <- fread(paste(dir,'NCAATourneyDetailedResults.csv',sep=''))
conferences <- fread(paste(dir,'Conferences.csv',sep=''))
team_conferences <- fread(paste(dir,'TeamConferences.csv',sep=''))
coaches <- fread(paste(dir,'TeamCoaches.csv',sep=''))
tour_enrich <- fread(paste(dir,'NCAATourneyDetailedResultsEnriched.csv',sep=''))
seas_enrich <- fread(paste(dir,'NCAASeasonDetailedResultsEnrichedv2.csv',sep=''))
dir <- '/Users/Marcelpv96/Dropbox/MASTER/1rANY/Q2/ML/Project/ML-Project/input/'
teams <- fread(paste(dir,'Teams.csv',sep=''))
seasons <- fread(paste(dir,'Seasons.csv',sep=''))
seeds <- fread(paste(dir,'NCAATourneySeeds.csv',sep=''))
seas_results <- fread(paste(dir,'RegularSeasonCompactResults.csv',sep=''))
tour_results <- fread(paste(dir,'NCAATourneyCompactResults.csv',sep=''))
seas_detail <- fread(paste(dir,'RegularSeasonDetailedResults.csv',sep=''))
tour_detail <- fread(paste(dir,'NCAATourneyDetailedResults.csv',sep=''))
conferences <- fread(paste(dir,'Conferences.csv',sep=''))
team_conferences <- fread(paste(dir,'TeamConferences.csv',sep=''))
coaches <- fread(paste(dir,'TeamCoaches.csv',sep=''))
tour_enrich <- fread(paste(dir,'NCAATourneyDetailedResultsEnriched.csv',sep=''))
seas_enrich <- fread(paste(dir,'NCAASeasonDetailedResultsEnrichedv2.csv',sep=''))
setkey(teams, TeamID)
setkey(seeds, TeamID)
g1 <-
teams[seeds][, one_seed := as.numeric(substr(Seed, 2, 3)) == 1][, sum(one_seed), by = TeamName][order(V1, decreasing = T)][1:15,] %>%
ggplot(aes(x = reorder(TeamName, V1), y = V1)) +
geom_bar(stat = 'identity', fill = 'darkblue') +
labs(x = '', y = 'No 1 seeds', title = 'No. 1 Seeds since 1985') +
coord_flip()
setkey(seas_results, WTeamID)
g2 <-
seas_results[teams][, .(wins = .N), by = TeamName][order(-wins)][1:15,] %>%
ggplot(aes(x = reorder(TeamName, wins), y = wins)) +
geom_bar(stat = 'identity', fill = 'darkblue') +
labs(x = '', y = 'Wins', title = 'Regular Season Wins since 1985') +
coord_flip()
setkey(tour_results, WTeamID)
g3 <-
tour_results[teams][, .(wins = .N), by = TeamName][order(-wins)][1:15,] %>%
ggplot(aes(x = reorder(TeamName, wins), y = wins)) +
geom_bar(stat = 'identity', fill = 'darkblue') +
labs(x = '', y = 'Wins', title = 'Tournament Wins since 1985') +
coord_flip()
g4 <-
tour_results[teams][DayNum == 154, .(wins = .N), by = TeamName][order(-wins)][1:15,] %>%
ggplot(aes(x = reorder(TeamName, wins), y = wins)) +
geom_bar(stat = 'identity', fill = 'darkblue') +
labs(x = '', y = 'Championships', title = 'Tournament Championships since 1985') +
coord_flip()
grid.arrange(g1, g2, g3, g4, nrow = 2)
win_stats <- seas_enrich[, .(
Season,
TeamID = WTeamID,
Result = rep('W', .N),
FGM = WFGM,
FGA = WFGA,
FGP = WFGM / WFGA,
FGP2 = (WFGM - WFGM3) / (WFGA - WFGA3),
FGM3 = WFGM3,
FGA3 = WFGA3,
FGP3 = WFGM3 / WFGA3,
FTM = WFTM,
FTA = WFTA,
FTP = WFTM / WFTA,
OR = WOR,
DR = WDR,
AST = WAst,
TO = WTO,
STL = WStl,
BLK = WBlk,
PF = WPF,
PIE = WPIE,
ORP = WOR / (WOR + LDR),
DRP = WDR / (WDR + LOR),
eFG = WeFGP,
NetRTG = WNetRtg,
POS = 0.96 * (WFGA + WTO + 0.44 * WFTA - WOR)
)]
win_stats <- seas_detail[, .(
Season,
TeamID = WTeamID,
Outcome = rep('W', .N),
FGM = WFGM,
FGA = WFGA,
FGP = WFGM / WFGA,
FGP2 = (WFGM - WFGM3) / (WFGA - WFGA3),
FGM3 = WFGM3,
FGA3 = WFGA3,
FGP3 = WFGM3 / WFGA3,
FTM = WFTM,
FTA = WFTA,
FTP = WFTM / WFTA,
OR = WOR,
DR = WDR,
AST = WAst,
TO = WTO,
STL = WStl,
BLK = WBlk,
PF = WPF,
ORP = WOR / (WOR + LDR),
DRP = WDR / (WDR + LOR),
POS = 0.96 * (WFGA + WTO + 0.44 * WFTA - WOR)
)]
los_stats <- seas_detail[, .(
Season,
TeamID = LTeamID,
Outcome = rep('L', .N),
FGM = LFGM,
FGA = LFGA,
FGP = LFGM / LFGA,
FGP2 = (LFGM - LFGM3) / (LFGA - LFGA3),
FGM3 = LFGM3,
FGA3 = LFGA3,
FGP3 = LFGM3 / LFGA3,
FTM = LFTM,
FTA = LFTA,
FTP = LFTM / LFTA,
OR = LOR,
DR = LDR,
AST = LAst,
TO = LTO,
STL = LStl,
BLK = LBlk,
PF = LPF,
ORP = (LOR / (LOR + WDR)),
DRP = LDR / (LDR + WOR),
POS = 0.96 * (LFGA + LTO + 0.44 * LFTA - LOR)
)]
stats_all <- rbindlist(list(win_stats, los_stats))
g1 <- stats_all %>%
ggplot(aes(x = FGP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goal %', y = '', title = 'Field Goal Shooting')
g2 <- stats_all %>%
ggplot(aes(x = FGP2, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '2 pt Field goal %', y = '', title = '2 Pt Field Goal Shooting')
g3 <- stats_all %>%
ggplot(aes(x = FGP3, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '3 pt Field goal %', y = '', title = '3 Pt Field Goal Shooting')
g4 <- stats_all %>%
ggplot(aes(x = FTP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Free throw %', y = '', title = 'Free Throw Shooting')
g5 <- stats_all %>%
ggplot(aes(x = ORP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Offensive rebound %', y = '', title = 'Offensive Rebounding Efficiency')
g6 <- stats_all %>%
ggplot(aes(x = DRP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Defensive rebouding %', y = '', title = 'Defensive Rebounding Efficiency')
g7 <- stats_all %>%
ggplot(aes(x = AST, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Assists', y = '', title = 'Assists per Game')
g8 <- stats_all %>%
ggplot(aes(x = TO, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Turnovers', y = '', title = 'Turnovers per Game')
g9 <- stats_all %>%
ggplot(aes(x = STL, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Steals', y = '', title = 'Steals per Game')
g10 <- stats_all %>%
ggplot(aes(x = BLK, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Blocks', y = '', title = 'Blocks per Game')
grid.arrange(g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, ncol = 2)
g1 <- stats_all %>%
ggplot(aes(x = FGP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goal %', y = '', title = 'Field Goal Shooting')
g1 <- stats_all %>%
ggplot(aes(x = FGP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goal %', y = '', title = 'Field Goal Shooting')
grid.arrange(g1, ncol=1)
g2 <- stats_all %>%
ggplot(aes(x = FGP2, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '2 pt Field goal %', y = '', title = '2 Pt Field Goal Shooting')
grid.arrange(g2, ncol=1)
g1 <- stats_all %>%
ggplot(aes(x = FGP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goal %', y = '', title = 'Field Goal Shooting')
g1 <- stats_all %>%
ggplot(aes(x = FGM, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goal %', y = '', title = 'Field Goal M/A ratio')
grid.arrange(g1, ncol=1)
View(stats_all)
g1 <- stats_all %>%
ggplot(aes(x = FGM, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goals %', y = '', title = 'Field Goal M/A ratio')
g1 <- stats_all %>%
ggplot(aes(x = FGP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goals %', y = '', title = 'Field Goal Shotting')
g2 <- stats_all %>%
ggplot(aes(x = FGP2, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '2 pt Field goal %', y = '', title = '2 Pt Field Goal Shooting')
g3 <- stats_all %>%
ggplot(aes(x = FGP3, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '3 pt Field goal %', y = '', title = '3 Pt Field Goal Shooting')
grid.arrange(g1, g2, g3, ncol=3)
grid.arrange(g1, g2, g3, ncol=3)
g1 <- stats_all %>%
ggplot(aes(x = FGP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Field goals %', y = '', title = 'Field Goal Shotting')
g2 <- stats_all %>%
ggplot(aes(x = FGP2, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '2 pt Field goal %', y = '', title = '2 Pt Field Goal Shooting')
g3 <- stats_all %>%
ggplot(aes(x = FGP3, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = '3 pt Field goal %', y = '', title = '3 Pt Field Goal Shooting')
g4 <- stats_all %>%
ggplot(aes(x = FTP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Free throw %', y = '', title = 'Free Throw Shooting')
grid.arrange(g1, g2, g3, g4, ncol=2)
g5 <- stats_all %>%
ggplot(aes(x = ORP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Offensive rebound %', y = '', title = 'Offensive Rebounding Efficiency')
g6 <- stats_all %>%
ggplot(aes(x = DRP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Defensive rebouding %', y = '', title = 'Defensive Rebounding Efficiency')
g7 <- stats_all %>%
ggplot(aes(x = AST, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Assists', y = '', title = 'Assists per Game')
g8 <- stats_all %>%
ggplot(aes(x = TO, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Turnovers', y = '', title = 'Turnovers per Game')
g9 <- stats_all %>%
ggplot(aes(x = STL, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Steals', y = '', title = 'Steals per Game')
g10 <- stats_all %>%
ggplot(aes(x = BLK, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Blocks', y = '', title = 'Blocks per Game')
grid.arrange(g5, g6, g7, g8, g9, g10, ncol = 2)
g5 <- stats_all %>%
ggplot(aes(x = ORP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Offensive rebound %', y = '', title = 'Offensive Rebounding Efficiency')
g6 <- stats_all %>%
ggplot(aes(x = DRP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Defensive rebouding %', y = '', title = 'Defensive Rebounding Efficiency')
g7 <- stats_all %>%
ggplot(aes(x = AST, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Assists', y = '', title = 'Assists per Game')
g8 <- stats_all %>%
ggplot(aes(x = TO, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Turnovers', y = '', title = 'Turnovers per Game')
g9 <- stats_all %>%
ggplot(aes(x = STL, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Steals', y = '', title = 'Steals per Game')
g10 <- stats_all %>%
ggplot(aes(x = BLK, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Blocks', y = '', title = 'Blocks per Game')
grid.arrange(g5, g6, g7, g8, g9, g10, ncol = 3)
g5 <- stats_all %>%
ggplot(aes(x = ORP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Offensive rebound %', y = '', title = 'Offensive Rebounding Efficiency')
g6 <- stats_all %>%
ggplot(aes(x = DRP, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Defensive rebouding %', y = '', title = 'Defensive Rebounding Efficiency')
g7 <- stats_all %>%
ggplot(aes(x = AST, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Assists', y = '', title = 'Assists per Game')
g8 <- stats_all %>%
ggplot(aes(x = TO, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Turnovers', y = '', title = 'Turnovers per Game')
g9 <- stats_all %>%
ggplot(aes(x = STL, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Steals', y = '', title = 'Steals per Game')
g10 <- stats_all %>%
ggplot(aes(x = BLK, fill = Outcome)) +
geom_density(alpha = 0.7) +
scale_fill_manual(values = c('darkblue', 'grey')) +
labs(x = 'Blocks', y = '', title = 'Blocks per Game')
grid.arrange(g5, g6, g7, g8, g9, g10, ncol = 2)
